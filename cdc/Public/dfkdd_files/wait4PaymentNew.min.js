var MJdUrl=(function(d){var c=function(a){this.ourl=a||window.location.href;this.href="";this.params={};this.jing="";this.init()};c.prototype.init=function(){var a=this.ourl;var j=a.indexOf("#");if(j>0){this.jing=a.substr(j);a=a.substring(0,j)}j=a.indexOf("?");if(j>0){this.href=a.substring(0,j);a=a.substr(j+1);var b=a.split("&");for(var i=0;i<b.length;i++){var h=b[i].split("=");this.params[h[0]]=h[1]}}else{this.href=this.ourl;this.params={}}};c.prototype.set=function(b,a){this.params[b]=a};c.prototype.remove=function(a){this.params[a]=undefined};c.prototype.url=function(){var a=this.href;var f=[];for(var b in this.params){if(this.params[b]){f.push(b+"="+this.params[b])}}if(f.length>0){a+="?"+f.join("&")}if(this.jing.length>0){a+=this.jing}return a};c.prototype.get=function(a){return this.params[a]};d.URL=c;return d}(MJdUrl||{}));(function(b){b.fn.loadPage=function(c){return new a(this[0],c)};var a=(function(){var c=function(e,d){this.init(d)};c.prototype={init:function(d){var e={containId:"",currentPage:1,baseUrl:"",beforeFn:null,successFn:null,errorFn:null,reLoad:true,isRepeatReq:false,maxHeightFlag:0,errorFlag:false,firstLoad:true};this.settings=b.extend(e,d);this.currentPage=e.currentPage;this.containId=e.containId;this.objContain=document.querySelector(this.containId);if(this.currentPage>1||this.settings.firstLoad){this.getData(this.currentPage)}this.currentPage++;this.events()},bindScrollEvts:function(){var d=this;window.onscroll=function(){b("body").css({height:document.documentElement.clientHeight});if((document.body.clientHeight+document.body.scrollTop)>=document.body.scrollHeight-356&&!d.settings.isRepeatReq&&!d.settings.errorFlag){d.settings.maxHeightFlag=document.body.scrollHeight;d.getData(d.currentPage++)}else{if((document.body.clientHeight+document.body.scrollTop)>=document.body.scrollHeight-356&&!d.settings.isRepeatReq&&d.settings.errorFlag){d.settings.maxHeightFlag=document.body.scrollHeight;d.getData(d.currentPage++)}}return false}},events:function(){this.bindScrollEvts();this.goBack2Top()},goBack2Top:function(){var g=document.querySelector("#indexToTop");var f="click",e=window.navigator.userAgent;var d={init:function(){d.scrollEvt();d.toTopEvt()},toTopEvt:function(){if(g){g.addEventListener(f,function(){scroll(0,0);g.style.display="none"},false)}},scrollEvt:function(){window.addEventListener("scroll",function(){var h=document.documentElement.clientHeight||document.body.clientHeight;var i=document.documentElement.scrollTop||document.body.scrollTop;if(i>h*2){g.style.display="block"}else{g.style.display="none"}},false)}};return d.init()},getData:function(e,d){if(!this.settings.isRepeatReq){this.settings.isRepeatReq=true}this.getSomeData(e)},EncodeUtf8:function(g){var h=escape(g);var d=h.split("%");var f="";if(d[0]!=""){f=d[0]}for(var e=1;e<d.length;e++){if(d[e].substring(0,1)=="u"){f+=Hex2Utf8(Str2Hex(d[e].substring(1,5)))}else{f+="%"+d[e]}}return f},getSomeData:function(e){var f=this;var d;d=f.settings.baseUrl+"&page="+e;b.ajax({url:d,type:f.settings.reqType,dataType:"json",beforeSend:f.settings.beforeFn,success:function(g){f.settings.successFn(g,f.currentPage);f.settings.reLoad=false;f.settings.isRepeatReq=false;f.settings.errorFlag=false},error:function(h,g){f.settings.errorFn(f.currentPage);f.settings.isRepeatReq=false;f.settings.errorFlag=true}})}};return c})();b.loadPage=function(c){b(document.body).loadPage(c)}})($);var sid;var isUseNewShopUrl;function goBack(){var a=location.href;if(a.indexOf("detail=true")!=-1){history.go(-4)}else{history.go(-1)}}$(function(){listC=$(".common-wrapper");sid=$("#sid").val();var d=$("#intlHost").val();var b=$("#newPayHost").val();var g=$("#presaleHost").val();var i=$("#itemHost").val();var h=document.querySelector(".is-loading");var a=false;isUseNewShopUrl=$("#isUseNewShopUrl").val();var j=$("#sendPay").val();var e=$("#home_orderlist_sendPay618").val();var f=function(){var k=document.querySelector(".is-loading");$.loadPage({containId:"#tab-wrapper",reqType:"GET",baseUrl:"/user/wait4Payment.json?sid="+sid,firstLoad:false,beforeFn:function(){if(k){if(!a){k.style.display="block"}}},successFn:function(m,l){if(k){k.style.display="none"}if(!m.orders||m.orders.length==0){a=true}else{a=false}c(m)},errorFn:function(l){var m=setTimeout(function(){if(k){k.style.display="none"}clearTimeout(m)},1000)}})};f();function c(k){if(k.orders&&k.orders.length>0){jQuery.each(k.orders,function(n,l){var p='<div class="m item border-1px mar9" id='+l.orderId+">";p+='<div class="mt bdb-1px">';if(l.canGoToShop){p+='<span class="i-icon02"></span><a name="'+l.shopId+'"href="javascript:;" sign="shop" class="shop-a cf"><span class="shop-name">'+l.shopName+'</span><span class="icon-point"></span></a>'}else{if(l.orderType=="106"){p+='<span class="i-icon02"></span>'+l.shopName}else{p+='<span class="i-icon"></span>'+l.shopName}}p+='<span class="i-info">';if(l.orderStatusId==5){if(l.isVirtualOrder){p+='<div class="signet"></div>'}else{p+='<a href="javascript:;" class="i-complete" name="'+l.orderId+'"/>';p+='<div class="signet"></div>'}}else{p+=l.orderStatusShow}p+='</span><div style="clear:both"></div></div><div class="mc"><a sign="orderDetail"';p+=' otc="'+l.isOtcSelfOrder+'" popSelf="'+l.isPopOrder+'"';var o=k.passKeyList[n];if(l.internationalType=="1"){var s="http://"+d+"/user/queryOrderDetailInfo.action?orderId={orderId}&from=wait4Payment&passKey={passKey}&sid="+sid;s=s.replace("{orderId}",l.orderId);p+='href2="'+s.replace("{passKey}",o)+'" >'}else{if(l.orderType=="106"){orderDetailUrl="/newAllOrders/querySamOrderInfo.action?orderId={orderId}&from=wait4Payment&passKey={passKey}&sid="+sid;orderDetailUrl=orderDetailUrl.replace("{orderId}",l.orderId);p+='href2="'+orderDetailUrl.replace("{passKey}",o)+'" >'}else{if(l.isVirtualOrder){if(l.virtualOrderInfo.redirectProtocol.type=="Native"){if(l.orderType=="37"){var s="http://newcz.m.jd.com/newcz/detail.action?orderId={orderId}&sid="+sid;s=s.replace("{orderId}",l.orderId);p+='href2="'+s+'" >'}else{if(l.orderType=="35"){var s="http://jipiao.m.jd.com/airline/orderDetail.action?orderId={orderId}&businessType={orderType}&sid="+sid;s=s.replace("{orderId}",l.orderId);p+='href2="'+s.replace("{orderType}",l.orderType)+'" >'}else{if(l.orderType=="87"){var s="http://cz.m.jd.com/flow/detail.action?orderId={orderId}&sid="+sid;s=s.replace("{orderId}",l.orderId);p+='href2="'+s+'" >'}}}}else{if(l.virtualOrderInfo.redirectProtocol.type=="M"){orderDetailUrl=l.virtualOrderInfo.redirectProtocol.url+"&sid="+sid;p+='href2="'+orderDetailUrl+'" >'}}}else{orderDetailUrl="/newAllOrders/queryOrderDetailInfo.action?orderId={orderId}&from=wait4Payment&passKey={passKey}&sid="+sid;orderDetailUrl=orderDetailUrl.replace("{orderId}",l.orderId);p+='href2="'+orderDetailUrl.replace("{passKey}",o)+'" >'}}}p+='<div class="imc-con bdb-1px">';if(l.isVirtualOrder){if(l.virtualOrderInfo.wareInfos&&l.virtualOrderInfo.wareInfos.length>0){var m;if(l.virtualOrderInfo.wareInfos[0]&&l.virtualOrderInfo.wareInfos[0].imgUrl){m=l.virtualOrderInfo.wareInfos[0].imgUrl.replace("/n5/","/n7/").replace("http://","//").replace("https://","//")}else{m=l.virtualOrderInfo.wareInfos[0].imgUrl}p+='<div class="imc-one"><div class="imco-l"><div class="imco-l-img-box"><div class="imco-l-img">';p+='<img src="'+m+'"> </div></div></div>';if(l.virtualOrderInfo.wareInfos[0].messages.length>0){var r=l.virtualOrderInfo.wareInfos[0].messages;p+='<div class="imco-r-content">';jQuery.each(r,function(t,u){p+='<div class="imco-r">';if(u.name!=""&&u.name!=null&&u.name!=undefined){if(u.msg!=""&&u.msg!=null&&u.msg!=undefined){p+=u.name+":"+u.msg}else{p+=u.name}}else{if(u.msg!=""&&u.msg!=null&&u.msg!=undefined){p+=u.msg}}p+="</div>"});p+="</div>"}p+="</div>";p+="</a></div>";p+='<div class="mb cf">';if(l.isPreSaleOrder){if(l.yushouState==0||l.yushouState==1){p+='<span class="true-payed">\u5b9a\u91d1:</span><span class="imb-num">&yen;'+l.yushouBargin+"</span>"}else{if(l.yushouState==2||l.yushouState==3||l.yushouState==4){p+='<span class="true-payed">\u5c3e\u6b3e:</span><span class="imb-num">&yen;'+l.yushouBalance+"</span>"}else{if(l.yushouState==5){p+='<span class="true-payed">\u5b9e\u4ed8\u6b3e:</span><span class="imb-num">&yen;'+l.price+"</span>"}}}}else{p+='<span class="true-payed">\u5b9e\u4ed8\u6b3e:</span><span class="imb-num">&yen;'+l.price+"</span>"}jQuery.each(l.buttons,function(u,t){if(t.showLabelId=="1"&&e=="true"){if(l.isPreSaleOrder){if(l.yushouState==1||l.yushouState==2||l.yushouState==4){p+=' <div class="imb-btn-box"><a class="imb-btn btn-gray">\u53bb\u652f\u4ed8</a></div>'}else{if(j!==null||j!==undefined||j!==""){p+=' <div class="imb-btn-box"><a sign="goToPay"  href="http://'+g+"/presalePay/presalePay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode="+l.payTypeCode+"&factPrice="+l.price+"&payType=presale&fromType=home.m.jd.com&sid="+sid+'"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{p+=' <div class="imb-btn-box"><a sign="goToPay"  href="http://'+g+"/presalePay/presalePay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode=-1&factPrice="+l.price+"&payType=presale&fromType=home.m.jd.com&sid="+sid+'"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}}}else{if(l.internationalType=="1"){if(j!==null||j!==undefined||j!==""){p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+d+"/pay/pay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode="+l.payTypeCode+"&factPrice="+l.price+"&fromType=home.m.jd.com&sid="+sid+'" class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+d+"/pay/pay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode=-1&factPrice="+l.price+"&fromType=home.m.jd.com&sid="+sid+'" class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}}else{if(l.isPickupOrder){p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+g+"/commonOrder/pay/commonOrderPay.action?orderId="+l.orderId+"&sid="+sid+'" class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{if(l.orderType=="106"){p+=' <div class="imb-btn-box"><a sign="goToPay"  href="http://'+g+"/generalOrder/pay/generalOrderPay?orderId="+l.orderId+'&payType=samclub"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{if(j!==null||j!==undefined||j!==""){p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+b+"/pay/pay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode="+l.payTypeCode+"&factPrice="+l.price+"&fromType=home.m.jd.com&sid="+sid+'"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+b+"/pay/pay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode=-1&factPrice="+l.price+"&fromType=home.m.jd.com&sid="+sid+'"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}}}}}}});p+="</div>";p+="</div>"}}else{if(l.orderMsg.wareInfoList&&l.orderMsg.wareInfoList.length>0){if(l.orderMsg.wareInfoList.length==1){var q;if(l.orderMsg.wareInfoList[0]&&l.orderMsg.wareInfoList[0].imageurl){q=l.orderMsg.wareInfoList[0].imageurl.replace("/n5/","/n7/").replace("http://","//").replace("https://","//")}else{q=l.orderMsg.wareInfoList[0].imageurl.replace("/n5/","/n7/")}p+='<div class="imc-one"><div class="imco-l"><div class="imco-l-img-box"><div class="imco-l-img">';p+='<img src="'+q+'"></div> </div></div>';p+='<div class="imco-r-content"><div class="imco-r">'+l.orderMsg.wareInfoList[0].wname+"</div></div></div>"}else{if(l.orderMsg.wareInfoList.length>1){p+='<div class="c-type-wrap carousel" id="carousel">';p+='<ul class="step-tab -type">';jQuery.each(l.orderMsg.wareInfoList,function(t,v){var u;if(v&&v.imageurl){u=v.imageurl.replace("http://","//").replace("https://","//")}else{u=v.imageurl}p+="<li>";p+='<div class="liimg">';p+='<img src="'+u+'">';p+="</div>";p+="</li>"});p+="</ul></div>"}}p+="</div>";p+="</a></div>";p+='<div class="mb cf">';if(l.isPreSaleOrder&&l.yushouPayType!=1){if(l.yushouState==0||l.yushouState==1){p+='<span class="true-payed">\u5b9a\u91d1:</span><span class="imb-num">&yen;'+l.yushouBargin+"</span>"}else{if(l.yushouState==2||l.yushouState==3||l.yushouState==4){p+='<span class="true-payed">\u5c3e\u6b3e:</span><span class="imb-num">&yen;'+l.yushouBalance+"</span>"}else{if(l.yushouState==5){p+='<span class="true-payed">\u5b9e\u4ed8\u6b3e:</span><span class="imb-num">&yen;'+l.price+"</span>"}}}}else{p+='<span class="true-payed">\u5b9e\u4ed8\u6b3e:</span><span class="imb-num">&yen;'+l.price+"</span>"}jQuery.each(l.buttons,function(u,t){if(t.showLabelId=="1"&&e=="true"){if(l.isPreSaleOrder){if(l.yushouState==1||l.yushouState==2||l.yushouState==4){p+=' <div class="imb-btn-box"><a class="imb-btn btn-gray">\u53bb\u652f\u4ed8</a></div>'}else{if(j!==null||j!==undefined||j!==""){p+=' <div class="imb-btn-box"><a sign="goToPay"  href="http://'+g+"/presalePay/presalePay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode="+l.payTypeCode+"&factPrice="+l.price+"&payType=presale&fromType=home.m.jd.com&sid="+sid+'"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{p+=' <div class="imb-btn-box"><a sign="goToPay"  href="http://'+g+"/presalePay/presalePay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode=-1&factPrice="+l.price+"&payType=presale&fromType=home.m.jd.com&sid="+sid+'"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}}}else{if(l.internationalType=="1"){if(j!==null||j!==undefined||j!==""){p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+d+"/pay/pay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode="+l.payTypeCode+"&factPrice="+l.price+"&fromType=home.m.jd.com&sid="+sid+'" class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+d+"/pay/pay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode=-1&factPrice="+l.price+"&fromType=home.m.jd.com&sid="+sid+'" class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}}else{if(l.isPickupOrder){p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+g+"/commonOrder/pay/commonOrderPay.action?orderId="+l.orderId+"&sid="+sid+'" class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{if(l.orderType=="106"){p+=' <div class="imb-btn-box"><a sign="goToPay"  href="http://'+g+"/generalOrder/pay/generalOrderPay?orderId="+l.orderId+'&payType=samclub"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{if(j!==null||j!==undefined||j!==""){p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+b+"/pay/pay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode="+l.payTypeCode+"&factPrice="+l.price+"&fromType=home.m.jd.com&sid="+sid+'"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}else{p+='<div class="imb-btn-box"> <a sign="goToPay"  href="http://'+b+"/pay/pay.action?orderId="+l.orderId+"&orderType="+l.orderType+"&orderTypeCode=-1&factPrice="+l.price+"&fromType=home.m.jd.com&sid="+sid+'"class="imb-btn">\u53bb\u652f\u4ed8</a></div>'}}}}}}});p+="</div>";p+="</div>"}}$("#allOrders").append(p);bindUserClickEvent()})}else{if(h){h.style.display="none"}}}bindUserClickEvent()});function IsAddFontCss(b,a){return(document.documentElement.clientWidth-10)*0.68*2<=b.getWidth(a)}function bindUserClickEvent(){$(".carousel").each(function(b){var d=$(this).find("li");var a=d.length;if(a>=4){$(this).children("ul").css({width:(d[0].clientWidth+9)*a});$(this).attr({id:"carousel"+b});var c=new IScroll("#"+$(this).attr("id"),{eventPassthrough:true,scrollX:true,scrollY:false,preventDefault:false})}});$(".mt").find("a[sign='shop']").each(function(a){$(this).unbind("click");$(this).click(function(){pingLevelClick(true,"Morder_Allorders_Shop","","","",3);var b=$(this).attr("name");setTimeout(function(){location.href="https://shop.m.jd.com/?shopId="+b},100)})});$(".mb").find("a[sign='goToPay']").each(function(a){$(this).unbind("click");$(this).click(function(){pingClick(true,"Morder_Allorders_Pay","","","")})});$(".mc").find("a[sign='orderDetail']").each(function(a){var b=$(this);$(this).unbind("click");$(this).click(function(){if($(this).attr("otc")=="true"){pingClick(true,"MOrderCenter_ListOTC","","","");setTimeout(function(){location.href=b.attr("href2")},100)}else{if($(this).attr("popSelf")=="true"){pingClick(true,"MOrderCenter_ListPop","","","");setTimeout(function(){location.href=b.attr("href2")},100)}else{pingClick(true,"Morder_Allorders_Detailed","","","");setTimeout(function(){location.href=b.attr("href2")},100)}}})});String.prototype.getWidth=function(b){var a=document.getElementById("_getwidthID");if(a==null){a=document.createElement("span");a.id="_getwidthID";document.getElementById("mainLayout").appendChild(a);a.style.visibility="hidden";a.style.whiteSpace="nowrap"}else{}a.style.display="inline-block";a.innerText=this;a.style.fontSize=b+"px";var c=a.offsetWidth;a.style.display="none";return c};$(".imco-r").each(function(a){if(IsAddFontCss($(this).text(),13)){$(this).addClass("unit-height")}})};