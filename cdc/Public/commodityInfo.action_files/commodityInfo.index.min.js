/*! m_order 2016-11-08 */
function processPrice(a){var b,c,d,e,f=$.trim($(a).html());b=/^.*(\D)(\d*)(\.\d{2})\d*\D*$/,c=f.replace(b,"$1"),d=f.replace(b,"$2"),e=f.replace(b,"$3");var g='<em class="sam-y">'+c+'</em><span class="sam-hund">'+d+"</span><em>"+e+"</em>";$(a).html(g)}function clickMessageTip(){$("#money-tip-pop").show();var a=$("#money-info-box").height(),b=a/2;$("#money-info-box").css({marginTop:-b});var c=document.getElementById("orderRemind"),d=document.getElementById("makeLocation");c&&d&&(c.style.display="none",d.style.display="none")}function setCookie(a,b,c,d){b=escape(b),""!=c&&(""!=d&&(d=";Path="+d),document.cookie=a+"="+b+";expires="+c+d)}function getCookieValue(a){var b=document.cookie,c=b.indexOf(""+a+"="),d=null;return c==-1&&(c=b.indexOf(a+"=")),c==-1?b=null:(c=b.indexOf("=",c)+1,d=b.indexOf(";",c),d==-1&&(d=b.length),b=unescape(b.substring(c,d))),b}$(function(){$(".sam-arrow").each(function(){$(this).click(function(){$(this).toggleClass("sam-a-up"),$(this).siblings(".seven-return").toggleClass("sam-info")})}),$(".sam-cost-price").each(function(){processPrice(this)})}),$(function(){$(".btn-remove").each(function(a,b){$(b).popMessage({cls:"error-icon",duration:1e3,message:"删除成功！",width:120,height:88,callBack:function(){var a,b,c=!0,d="commodity_"+this._this.attr("wareId");return $.ajax({dataType:"json",type:"post",url:"/norder/removeCommodityBySkuId.json",async:!1,data:{sid:this._this.attr("sid"),wareId:this._this.attr("wareId"),stockStatusValue:this._this.attr("stockStatusValue"),flowType:this._this.attr("flowType")},cache:!1,success:function(a,b){c=!0,$("#"+d).remove(),localStorage.setItem("deleteCommodityFlag","true")},error:function(a,b,d){c=!1}}),c?(a="删除成功!",b="succee-icon"):(a="删除失败!",b="error-icon"),this.cls=b,this.message=a,!0}})})}),function(){$.fn.popMessage=function(a){var b,c=$(this),d={duration:1e3,message:"关注成功",cls:"",width:145,height:88,_this:c,callBack:function(){}},e=$.extend(d,a),f=null,g={addHtml:function(){var a='<div class="message-floor" id="messageBox">';a+='<div class="messge-box">',a+='<div class="messge-box-icon"><i class="bottom-focus-icon '+e.cls+'"></i></div>',a+='<div class="messge-box-content">'+e.message+"</div>",a+="</div>",a+="</div>",$("body").append(a)},adjustHeight:function(){var a=document.documentElement.clientHeight;$(b).find(".messge-box")[0].style.marginTop=(a-e.height)/2+"px"},setInfo:function(){$(b).find(".messge-box-content").text(e.message),$(b).find(".messge-box").width(e.width+"px"),$(b).find(".bottom-focus-icon").attr("class","bottom-focus-icon "+e.cls)}},h=function(){0==$("#messageBox").length&&g.addHtml(),b=document.getElementById("messageBox"),g.adjustHeight(),k()},i=function(){var a=e.callBack();void 0!=a&&null!=a&&(g.setInfo(),b.style.display="block",null!=f&&clearTimeout(f),f=setTimeout(function(){j(),f=null},e.duration))},j=function(){b.style.display="none"},k=function(){c.bind("click",function(a){a.preventDefault(),i()})};return h()}}(),function(a){if(document.getElementById("orderRemind")){setTimeout(function(){pingClick(a("#cartUse").val(),"MNeworder_NotificationCenter","","","")},0);var b=document.getElementById("orderRemind"),c=document.getElementById("makeLocation"),d=document.getElementById("closeRemind"),e="messageTipCookie",f=function(){b.style.display="none",c.style.display="none"};c.style.height=c.offsetHeight+"px",b.style.display="none",c.style.display="none",window.addEventListener("scroll",function(){var a=document.documentElement.scrollTop||document.body.scrollTop;a>=45?(b.style.position="fixed",b.style.top="0px",b.style.left="0px"):b.style.position="static"},!1),d.onclick=function(){b.style.display="none",c.style.display="none";var d=new Date;d.setTime(d.getTime()+864e5),setCookie(e,!1,d.toGMTString(),""),setTimeout(function(){pingClick(a("#cartUse").val(),"MNeworder_CloseNotificationCenter","","","")},0)},"false"!=getCookieValue(e)&&(b.style.display="block",c.style.display="block");var g=0;a("#shipping-pop .ship-ftw").bind("click",function(){a(window).scrollTop(g),a("#shipping-pop").hide(),a("body").css({height:"auto",overflow:"inherit"})}),a("#icon-detailed").bind("click",function(){g=a(window).scrollTop();var b=document.documentElement.clientHeight;a(window).scrollTop(g),a("body").css({height:b,overflow:"hidden"}),a("#shipping-pop").show();var c=a("#ship-info-box").height(),d=c/2;a("#ship-info-box").css({marginTop:-d}),a(".shipping-guess-cover").jdSlider({lineNum:1,fitToScreen:!0,marginLeft:12})}),a(".ship-ftw").bind("click",function(){a(this).parents(".shipping-pop-floor").hide(),f();var b=new Date;b.setTime(b.getTime()+864e5),setCookie(e,!1,b.toGMTString(),"")}),a.fn.jdSlider=function(b){return this.each(function(){var c,d=0,e=this,f=a(this).find(".jd-slider-container"),g=a(this).find(".jd-slider-item"),h=0,i=!1,j=g.eq(0).width()+b.marginLeft,k=0,l="onorientationchange"in window,m=l?"orientationchange":"resize",n={initX:0,initY:0,startX:0,endX:0,sliderX:0,_sliderDirection:1,startY:0,sliderFlag:!1,finalX:0,runFlag:!0},o=a.extend({lineNum:1,fitToScreen:!1,isCoupon:!0,sliderWidth:h,sliderItemWidth:j,sliderX:k,itemPerScreen:d,wrapperWidth:c,isRight:!1},b),p=function(){if(o.wrapperWidth=a(e).width(),1==o.lineNum){for(var c=0,d=0;d<g.length;d++)c=c+g.eq(d).width()+b.marginLeft;o.sliderWidth=c}else o.sliderWidth=(Number(g.width())+b.marginLeft)*parseInt(g.length/o.lineNum)+10;o.itemPerScreen=parseInt(o.wrapperWidth/o.sliderItemWidth),o.sliderX=o.itemPerScreen*o.sliderItemWidth,f.css({width:o.sliderWidth})},q=function(b){n.runFlag&&(a("#suite-slider").attr("opend")&&f.css("-webkit-transform","translate3d(0,0,0)"),n.endX=0,p(),o.sliderWidth<=o.wrapperWidth&&(i=!0),window.addEventListener(m,function(){clearTimeout(a);var a=setTimeout(function(){p()},200)}))},r=function(a){n.runFlag=!1,f.css("-webkit-transform","translate3d("+(n.endX=a)+"px,0,0)"),f.css("-webkit-transition","500ms")};return e.addEventListener("touchstart",function(a){if(!i){n.sliderFlag=!0;var b=a.touches[0];n.startX=b.pageX,n.initX=b.pageX,n.finalX=b.pageX,n.initY=b.pageY,a.stopPropagation()}}),e.addEventListener("touchmove",function(a){if(!i){var b=a.touches[0];n.sliderFlag&&Math.abs(b.pageY-n.initY)/Math.abs(b.pageX-n.initX)<.6?(n._sliderDirection=b.pageX-n.startX<0?"LEFT":"RIGHT",n.finalX=b.pageX,a.preventDefault()):n.sliderFlag=!1,a.stopPropagation()}}),f[0].addEventListener("webkitTransitionEnd",function(){n.runFlag=!0},!1),e.addEventListener("touchend",function(a){if(!i&&n.sliderFlag){a.touches[0];if(!(Math.abs(n.finalX-n.startX)<50)){if(n.endX>0)r(n.endX=0);else if(n.endX<-(o.sliderWidth-o.wrapperWidth))r(n.endX=-(o.sliderWidth-o.wrapperWidth));else if("LEFT"==n._sliderDirection){if(o.isCoupon){var b=o.sliderWidth-o.sliderX;b-Math.abs(n.sliderX)<o.wrapperWidth&&(o.isRight=!0),n.sliderX=b-Math.abs(n.sliderX)<o.wrapperWidth?-(o.sliderWidth-o.wrapperWidth):n.sliderX-o.sliderX}else{var b=o.sliderWidth-o.wrapperWidth;n.sliderX=b-Math.abs(n.sliderX)<o.wrapperWidth?-b:n.sliderX-o.wrapperWidth}r(n.sliderX)}else o.isCoupon?o.isRight?(o.isRight=!1,n.sliderX=n.sliderX+o.wrapperWidth>0?0:n.sliderX+2*o.sliderX-o.wrapperWidth):n.sliderX=n.sliderX+o.wrapperWidth>0?0:n.sliderX+o.sliderX:n.sliderX=n.sliderX+o.wrapperWidth>0?0:n.sliderX+o.wrapperWidth,r(n.sliderX);n.sliderFlag=!1,a.stopPropagation()}}}),q()})}}}(jQuery),$(function(){$(".ship-ftw").bind("click",function(){$(this).parents(".shipping-pop-floor").hide()}),$("#moneyTip2").bind("click",function(){$("#money-tip-pop2").show();var a=$("#money-info-box2").height(),b=a/2;$("#money-info-box2").css({marginTop:-b})})});